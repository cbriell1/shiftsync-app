import { prisma } from '../../../../lib/prisma';
import { NextResponse } from 'next/server';

export async function POST() {
  // Wipe existing data so we can do a clean import
  await prisma.passUsage.deleteMany({});
  await prisma.member.deleteMany({});

  const rawCSV = `Last,First,,Notes,Family,Renewal Date,Total,Remain,,,,Date / No. / Initials,,,Date / No. / Initials,,,Date / No. / Initials,,,Date / No. / Initials,,,Date / No. / Initials,,,Date / No. / Initials,,,Date / No. / Initials,,,Date / No. / Initials,,,Date / No. / Initials,,,Date / No. / Initials,,,
Adams,Jonathan,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Adams,Bryan ,WF,,,03-01-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Agadzhanov,Artem,WF,,,03-11-26,12,3,04-25-25,3,CRE,05-27-25,1,BVP,06-12-25,2,WH,10-27-25,1,LP,10-29-25,1,BVP,12.6.25,1,SEW,,,,,,,,,,,,,,,,,,,
Aghajanian,Akbar,CH,,Zahra Tashakkori,02-01-27,12,11,2.5.26,1,SEW,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Agudo,Esteban ,CH,,Megan Arvidson,11-01-26,12,8,12-24-25,1,JS,2.7.26,2,SEW,02-02-29,1,SF,,,,,,,,,,,,,,,,,,,12-24-25,1,JS,,,,,,,
Akins,Joy,CH,,Steve Buttitta,01-01-27,12,6,01-03-26,6,SEW,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Alexander,Linda,CH,Medical Suspension,,01-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Ali,Yusuf,Gr,,,06-17-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Arleth,Jim,CH,Purchased 13 Black Friday sale guest passes that will not expire - will add when yearly 12 used up,,09-01-26,15,2,09-07-25,1,CRE,11-15-25,1,CRE,11-25-25,1,VJW,12-14-25,1,CRE,12-24-25,1,LP,12-27-25,1,CRE,12-29-25,1,LP,12-31-25,1,JS,01-04-26,3,CRE,01-11-26,1,CRE,1.24.26,1,SEW,,,,
Arvidson,Megan,CH,,See Esteban Agudo,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Balamucki,Richard ,CH,,Cindy Piontak,01-05-27,12,11,01-26-26,1,MCE,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Barrett,Ken,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Barrett,Ken,WF,,,07-09-26,12,3,07-22-25,3,LP,08-15-25,3,KS,11.29.25,3,WAH,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Battershall,Eileen ,WF,,,01-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Beach,Shannon ,WF,,"Evan Beach
Eric Beach",11-06-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Beasley ,Jeri,Gr,,,07-27-26,12,9,12-01-25,1,SK,12-22-25,1,LP,01-05-26,1,LP,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Bello,Lan ,WF,,,01-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Belongia,Allison,WF,,"Rich Belongia
Sadie Belongia",06-24-26,12,9,01-03-26,3,SF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Bertrand,Alyssa,CH,Student Platinum Membership,,08-17-26,12,11,12-18-25,1,?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Bharwani,Amy Fields ,CH,Medical Suspension,,02-08-26,12,9,03-25-25,1,VJW,05-28-25,1,MP,09-06-25,1,LP,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Bischoff,Christine ,CH,,,01-01-27,12,10,01-16-26,2,JS,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Bledsoe,Finn,CH,,,08-05-26,12,3,08-04-25,1,ME,08-11-25,1,?,8/16/25,1,JS,08-19-25,1,BVP,08-29-25,1,CRE,09-06-25,1,WH,09-13-25,1,BVP,09-26-25,1,CRE,01-17-26,1,?,,,,,,,,,,
Blum,Cynthia,CH,,,03-01-26,12,2,06-21-25,3,?,08-25-25,3,MCE,10-21-25,1,BVP,12.20.25,3,SEW,,,,,,,,,,,,,,,,,,,,,,,,,
Boast,Stokley ,CH,,,01-01-27,12,9,2.14.26,3,SEW,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Bobo,Susan ,WF,,,12-01-26,12,8,12.01.25,1,WAH,12-27-25,1,wh,01-02-26,1,lp,01-06-26,1,lp,,,,,,,,,,,,,,,,,,,,,,,,,
Bordeaux,Blair,WF,This is a 6 month Platinum so he gets 6 Guest Passes,,09-01-26,6,6,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Borgman ,James ,WF,,,06-03-26,12,8,06-28-25,1,CL,07-19-25,3,JS,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Botkin,Rob,,Won 8 guest passes from a raffle,,N/A,8,4,04-05-25,4,SK,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Boulton,Chris,CH,Medical Suspension,,01-01-27,12,10,2.14.26,2,SEW,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Boyce,Greg,,GP for Canceled Tourney,,04-23-26,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Braid,Derek,WF,,,01-01-27,12,9,01-19-26,1,LP,02-01-26,1,LP,01-30-26,1,lp,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Branon,Kerry ,CH,,,12-18-26,12,10,01-22-26,2,?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Brekke,Kate,CH,Medical Suspension,,01-22-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Brewer,Steve,WF,,,10-22-26,12,11,01-10-26,1,WH,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Briell,Christopher ,Br,,,12-29-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Brown ,Tammy ,WF,,,02-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Bruno,George,Gr,,"Henry Bruno
Jennifer Bruno",11-12-26,12,11,02-06-26,1,cb,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Buhrke,Robin ,CH,,,01-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Burleson,Doug,,GP for Canceled Tourney,,04-23-26,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Bush,Wendy ,CH,,+2 for best dressed win,01-01-27,14,14,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Cala,Mario,Gr,,,03-15-26,12,4,03-16-25,2,SK,03-22-25,2,LP,05-04-25,2,LP,01-17-26,2,cb,,,,,,,,,,,,,,,,,,,,,,,,,
Capone,John,CH,,,09-01-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Carroll,Jenny,WF,,,06-19-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Carpenter,Sarah,CH,College Platinum,,12-26-26,12,11,02-16-26,1,ME,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Castle,Kathleen,WF,Purchased 13 during Black Friday sale,Evan & Mark,11-29-26,25,25,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Cheney,Chris ,WF,Medical Suspension,Stephanie Cheney,12-09-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Chen,Qi,CH,,,06-12-26,12,12,01-27-26,1,SF,02-03-26,1,SF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Clark,Kathy ,CH,,Robert Clark,11-19-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Cook,Donald,CH,Medical Suspension,,06-30-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Cortright,Alex,,Holiday Classic Winner,,12-07-25,2,2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Cosler,Don ,WF,,,01-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Councilman,Jackson,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Courtney,Karen,CH,They won 4 passes at a social,Josh Kalish,02-10-26,16,16,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Cowell,Sue ,CH,Medical Suspension,,03-16-26,12,0,03-28-25,1,LP,03-31-25,2,VJW,05-02-25,2,BVP,05-10-25,1,CRE,05-24-25,1,LP,06-13-25,1,VJW,07-02-25,1,LP,08-10-25,1,LP,09-10-25,1,JS,11-04-25,1,SF,,,,,,,
Cronin,Donald ,WF,,,01-01-27,12,11,01-16-26,1,lp,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Culham,Andrew ,WF,,,12-23-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Czuba,George,,From Eric for missing a lesson,,,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Daily,Bill ,WF,,,12-16-26,12,9,12-26-25,3,LP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Darden,Brent ,CH,,,01-01-27,12,11,02-13-26,1,LP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Davis,Britt ,WF,,Carol Dombroski,11-01-26,12,7,11.13.25,1,WAH,12-12-25,1,EG,12-21-25,2,MJS,02-14-26,1,RB,,,,,,,,,,,,,,,,,,,,,,,,,
Demarest,Renee,Gr,,,01-02-27,12,11,01-05-26,1,lp,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Do,Ben,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Donovan,Chelsea,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Duarte,Ricardo,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Dupree-Somers,Sandy,WF,,,02-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Einhorn,Philip,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Elk,Marissa ,CH,Won 4 at beach party,,01-01-27,16,12,02-07-26,1,WH,2.7.26,3,SEW,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
English,Chelsea ,CH,Employee Platinum,,01-22-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Evans,Nathan,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Falk,Charlie,CH,,,01-23-27,12,9,1.24.26,3,SEW,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Fanelly,Susan ,WF,Employee Platinum,,01-22-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Fayson,James ,CH,,,01-01-27,12,11,02-08-26,1,CRE,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
FitzPatrick,Alicia,CH,,,11-06-26,12,10,12-13-25,1,JS,01-10-26,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Fleischman,Diane ,CH,,,01-10-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Florentino,Michael ,WF,,,01-01-27,12,11,01-03-26,1,NL,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Foster,Taheya,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Franklin,Jeff ,CH,Black Friday 13 passes,,09-16-26,25,12,09-28-25,1,LP,10-21-25,1,WH,12-14-25,1,LP,12-22-25,1,CRE,01-11-26,1,CRE,1.17.26,2,SEW,01-27-26,1,BVP,02-02-26,1,SF,02-07-25,1,WH,02-02-26,1,SF,02-10-26,1,BVP,02-17-26,1,BVP
,,,,this row is for Jeff Franklin,,,,02-18-26,1,VW,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Fraser,Stephen ,CH,,,08-15-26,12,5,09-07-25,2,CRE,09-28-25,3,CRE,12/13/25,2,CRE,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Frost,Cynthia,CH,Black Friday 13 Passes,,01-22-27,25,16,07-05-25,2,CRE,07-12-25,1,CRE,08-02-25,1,MP,08-01-25,2,LP,11.16.25,2,sew,01-03-26,2,CRE,01-17-26,1,VJW,,,,,,,,,,,,,,,,
Gagnon,Marc,CH,,,01-05-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Gant,Jedidiah,,Holiday Classic Winner,,12-07-25,1,0,01-18-26,1,MM,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Gaskins,Jesse,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Genet,Kit,Gr,,Fred,12-19-26,12,0,12-28-25,2,LP,12-29-25,2,LP,1/4/2026,2,FJ,01-21-26,1,LP,01-16-26,1,lp,02-01-26,2,lp,01-28-26,2,lp,,,,,,,,,,,,,,,,
George,Joe ,CH,,,01-03-27,12,10,01-14-26,1,LP,01-27-26,1,SF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Gilbert,Eric,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Gilbert,Ryan,,,,06-04-26,12,0,07-02-25,1,WH,10-23-25,1,BVP,10-30-25,1,BVP,11-13-25,1,LY,11-28-25,1,CRE,11-30-25,1,CRE,12-09-25,1,BVP,01-15-26,1,JS,1.17.26,1,SEW,01-20-26,1,EJ,01-27-26,1,EJ,02-17-26,1,BVP
Gilbert,Jason ,,?,,01-16-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Goldstein,Michael ,WF,,,02-14-26,12,3,02-21-25,1,LP,05-08-25,1,LP,08-03-25,1,LP,09-20-25,1,RB,11-13-25,1,LP,11.13.25,1,WAH,12-11-25,1,LP,01-19-26,1,WAH,02-08-26,1,MM,,,,,,,,,,
Goodman,Jill ,CH,,,01-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Greback-Clarke,Paul,CH,,,08-12-26,12,6,12-15-25,1,JS,12-16-25,1,JS,02-07-26,1,SEW,2.14.26,3,SEW,,,,,,,,,,,,,,,,,,,,,,,,,
Greenberg,Ben ,Gr,,,12-23-26,12,6,01-11-26,3,SK,02-20-26,3,MM,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Greenberg,Helene,WF,,,08-19-26,12,11,09-06-25,1,LP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Gregoire,Sally ,CH,,,01-01-27,12,8,01-03-26,1,CRE,01-07-26,1,JS,01-14-26,2,LP,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Groeschner,Lisa ,WF,Employee Platinum,,01-22-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Groom,Matthew,WF,,,10-04-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Gustafson,Susan ,WF,,,07-11-26,12,7,10-21-25,1,LP,11-13-25,3,LP,12-12-25,1,MM,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Gutierrez,Victor ,,GP for Canceled Tourney,,04-23-25,1,0,05-10-25,1,CL,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Hahn,Stacy,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Hansbrough,Tyler ,CH,,,02-05-27,12,11,02-07-26,1,WH,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Harper,Kathleen,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Hart,Derrick ,WF,Medical Suspension,,11-11-26,12,10,01-17-25,2,LP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Harwood,Yvonne,WF,,Chris Grimes,05-01-26,12,8,09-14-25,2,EJ,12-31-25,2,WH,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Haywood,Ebony,WF,,,07-01-26,12,9,07-01-25,1,MC,11-04-25,1,SF,01.24.26,1,WAH,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Heck,June,CH,,,07-01-26,12,6,08-08-25,1,MP,08-20-25,1,VJW,09-24-25,1,MP,09-21-25,1,LP,10-25-25,2,LP,,,,,,,,,,,,,,,,,,,,,,
Hinkson,Steve,CH,,,11-27-26,12,10,11-30-25,2,CRE,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Howe ,Wendy ,,Employee Platinum,,02-05-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Hsieh,Sonia,CH,Medical Suspension,,02-07-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Huang,Hans ,Gr,,Summer Wang,08-16-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Hudson,Wade,WF,Employee Platinum,,07-10-26,12,3,07-15-25,1,MM,07-19-25,1,?,10/1/25,1,MM,12-09-25,1,LP,12-18-25,1,JS,01-03-26,1,NL,01-17-26,2,WAH,02.07.26,1,WAH,,,,,,,,,,,,,
Hunt,Michelle ,CH,,John Turnley,05-06-27,12,5,05-09-25,1,VJW,05-23-25,1,LP,05-24-25,1,?,06-13-25,1,VJW,09-22-25,1,ME,10-05-25,1,CRE,01-13-26,1,?,,,,,,,,,,,,,,,,
Hunt,Perry ,WF,,,11-27-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Hunter,Sue ,CH,,"Stough Garrison",11-19-26,12,9,01-07-26,3,JS,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Hurtt,Beth,CH,,Nathan Gaddis,01-31-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Hutton ,Alyssa ,Gr,,Kyle Hutton,01-10-27,12,7,01-11-26,4,SK,02-07-26,1,LP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Huynh,Dan ,CH,,,08-29-26,12,2,08-30-25,1,CRE,09-07-25,2,CRE,09-08-25,1,ME,10-09-25,1,BVP,11-24-25,1,ME,12-08-25,1,ME,12-10-25,1,BVP,01-18-26,1,VJW,02-15-26,1,CRE,,,,,,,,,,
Ibarra,Fannia,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Israel,Judi,CH,,,01-07-27,12,11,01-31-26,1,CRE,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Jaques,Christopher ,CH,used passes,,02-18-26,12,4,03-16-25,2,CRE,03-17-25,1,CRE,05-26-25,1,ME,08-03-25,1,WH,12-02-25,2,lp,01-23-26,1,LP,,,,,,,,,,,,,,,,,,,
Jennings,Bryan ,CH,,Peggy,10-01-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Jiang,Josie,CH,,,06-24-26,12,11,06-29-25,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Jimenez,Esther ,WF,,,01-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Johnson,Shawn ,WF,,,09-14-26,12,11,01-31-26,1,EB,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Johnson,Shelley,CH,,,07-12-26,12,6,12.20.25,1,SEW,12.27.25,1,SEW,01-01-26,1,LP,02-11-26,1,BVP,02-12-26,0,0,02-18-26,1,BVP,,,,,,,,,,,,,,,,,,,
Johnson,Todd ,Gr,,,05-29-26,12,5,07-10-25,1,lp,08-05-25,1,lp,08-15-25,1,Lp,08-18-25,1,LP,10-03-25,1,LP,10-25-25,1,RB,11-28-25,1,LP,,,,,,,,,,,,,,,,
Jose,Robert ,WF,,,03-01-26,12,4,05-31-25,1,CL,10-06-25,1,JS,10-25-25,1,?,11-08-25,1,?,12-13-25,1,JS,01-02-26,1,MM,12-20-25,1,MM,02-12-26,1,SF,02-22-26,1,EJ,,,,,,,,,,
Kane,Trish,CH,,,07-23-26,12,10,07-27-25,1,CRE,01-20-26,1,VJW,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Kang,Grace,CH,,,01-01-27,12,11,01-10-26,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Kapp,Kelly ,WF,,,12-11-26,12,7,01-14-26,3,MM,01-15-26,1,JS,01-21-26,1,MM,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Keaton,Dallas,Gr,,Sarah Keaton,05-18-26,12,8,06-07-25,1,CA,07-20-25,2,CA,11-04-25,1,EG,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Keith,Sandi ,CH,,,06-25-26,12,0,06-29-25,1,LP,06-30-25,1,ME,07-10-25,1,WH,07-21-25,2,WH,08-07-25,1,JS,08-10-25,1,LP,12-01-25,1,ME,12-22-25,1,LP,01-03-26,1,CRE,01-18-26,2,VJW,,,,,,,
Kilpatrick,Denise ,WF,,,09-14-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Kim,Femi,CH,,,02-18-26,12,0,07-11-25,1,MM,12/14/25,6,CRE,02-15-26,5,CRE,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Kimmerly,Aron,CH,,Qi Chen,06-12-26,12,8,07-22-25,2,CRE,01-30-26,1,CRE,02-17-26,1,CRE,,,,,,,,,,,,,,,,,,,,,,,,,,,,
King,Evan,,GP for Canceled Tourney,,04-23-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
King,Mark,WF,,,03-01-26,12,0,06-05-25,1,LP,08-01-25,3,EE,09-26-25,3,EE,12-10-25,2,MM,12-31-25,2,LP,02.16.26,1,,,,,,,,,,,,,,,,,,,,
Klee,Marissa ,CH,,,10.28.26,12,4,12-07-25,1,CRE,12-14-25,1,CRE,12-17-25,1,BVP,01-21-26,1,BVP,01-25-26,1,CRE,01-28-26,1,JS,01-29-26,1,VJW,01-30-26,1,CRE,,,,,,,,,,,,,
Klett,Kelly ,WF,,,12-01-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Koren,Benjamin,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Kozar,Carol ,WF,,,01-15-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Kreivenas,Augie ,CH,,,11-14-26,12,10,02-05-26,2,SEW,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
LaRocca,Tyrus,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Lawrence,Russell ,WF,,,12-01-26,12,10,12-04-25,1,LP,12-18-25,1,LP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Lee,Jennifer,WF,,Ray Lee,01-03-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Lefavor,Nicholas,Gr,,,08-18-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Lester,Christopher ,Gr,,Mackenzie,07-28-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Lightbourn,Robert ,CH,,,08-04-26,12,8,09-28-25,1,CRE,10-12-25,1,JS,02-13-26,2,LP,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Lilley,James ,WF,,Melanie Lilley,01-02-27,12,10,01-07-26,1,LP,02-24-26,1,LP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Lindley,Chris,CH,,,01-13-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Loehr,Laura ,CH,,Steve Loehr,02-10-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Longnecker,Matthew,CH,,Stephanie London,02-12-26,12,2,04-07-25,1,VJW ,07-03-25,2,LP,07-09-25,1,LP,08-08-25,1,LP,08-30-25,1,CRE,10-25-25,1,CRE,01-03-26,1,CRE,01-31-26,1,CRE,02-08-26,1,CRE,,,,,,,,,,
Lu,Michael ,CH,,,01-05-27,12,9,01-05-26,3,SEW,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Lundie,Helen ,,,,09-15-24,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Madariaga,Eric,CH,,Holly Madariaga,11-01-26,12,9,12-14-25,1,CRE,12-14-25,1,LP,01-23-26,1,LP,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Manchester,Ryan,WF,,,06-14-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Mannheim,William,CH,,,07-01-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Margolis,Aimee ,CH,,David Margolis,01-01-27,12,11,01-17-26,1,VJW,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Matthews,Jordan,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
McDaniels,Clayton,WF,,,07-18-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
McFerren,Kelly ,WF,,,02-06-27,12,11,02-14-26,1,RB,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
McGee,Sarah,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
McHale,Luke,WF,,,02-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
McHale,Patricia,WF,,,02-01-27,12,11,02-10-26,1,EG,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
McIndoe,James ,CH,Medical Suspension,,04-01-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
McRowan,Edward,WF,Medical Suspension,,03-01-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Messina,Sharon ,CH,,Fred Messina,01-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Metz,Sandi ,CH,,Amy Germuth,01-01-27,12,8,01-21-26,1,JS,01-24-26,1,CRE,02-02-26,1,ME,02-16-26,1,LP,,,,,,,,,,,,,,,,,,,,,,,,,
Miyai,Kay ,WF,,,04-01-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Mohr,Michelle,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Molina,Grace,CH,,,01-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Molino,Manuel,CH,2 passes added,Cristina Maranto,10-14-26,14,8,12-15-25,1,JS,12-16-25,1,JS,12-17-25,1,BVP,12.21.25,1,SEW,12-29-25,1,LP,12-30-25,1,BVP,,,,,,,,,,,,,,,,,,,
Molovinsky,Evan,,GP for Canceled Tourney,,04-23-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Moore,Jordan,Gr,,,12-29-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Muthukumar,Shankar,WF,,,01-07-27,12,11,01-18-26,1,MM,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Nadler,Lisa ,CH,,,09-01-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Neal,Chris,CH,,,01-13-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Neal,Kawi ,WF,,,11-08-26,12,11,12-28-25,1,WAH,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Nelson,Jay ,WF,,,01-01-27,12,9,01-17-26,2,LP,02-15-26,1,Lp,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Nielsen,Holly,Gr,,,08-01-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Nguyen,Henry,WF,,,07-17-26,12,11,07-18-25,1,MM,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Nini,Marilyn,CH,,Rob Nini,12-04-26,12,10,12.6.25,2,SEW,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Oakes,John,WF,,,02-05-27,12,11,02-15-26,1,MM,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
O'Brien ,Richard ,CH,,,07-19-26,12,3,12.4.25,1,SEW,12-09-25,1,BVP,12.18.25,1,SEW,12-23-25,1,BVP,12-28-25,1,WH,1.8.26,1,SEW,1.22.26,1,sew,2.7.26,1,SEW,02-08-26,1,CRE,,,,,,,,,,
Olsen,Todd ,,,,10-18-26,12,9,01-03-26,3,?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Olsen,Shawn ,,,Kimberly Olsen,12-15-26,12,8,01-16-26,2,MM,2-11-26,2,lp,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Olson,Thomas ,CH,,,01-22-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Ortiz,Ronnie,WF,,,05-09-26,12,9,06-22-25,1,LP,12-13-25,2,JS,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Page,Christy,CH,Family ,Branson Page,05-28-26,12,6,05-26-25,2,ME,07-06-25,1,WH,07-21-25,1,WH,12.11.25,1,SEW,01-24-26,1,CRE,,,,,,,,,,,,,,,,,,,,,,
Parker,Deborah,CH,,Ray Parker,02-01-27,18,18,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Patterson,Rudy,WF,,,12-29-26,12,9,1.17.26,1,WH,01-22-26,1,lp,02-19-26,1,LP,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Peek,Donna ,WF,,,01-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Peller,Ric,WF,,,12-29-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Pellerin,Chance,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Peraza,Ruben ,WF,,,11-27-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Pham,Mike ,WF,,,11-20-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Polish,Allison,CH,,,09-01-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Pollone,Leesa ,,Employee Platinum,,05-21-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Porter-Smith,Carolyn,WF,,,01-13-27,12,11,02-15-26,1,MM,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Poston,Stacey ,CH,,,01-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Power,Victoria,CH,,,11-10-26,12,10,11-28-25,1,CRE,01-31-26,1,CRE,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Presnell,Aaron,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Presser,Matt ,CH,,,12-06-26,12,11,01-07-26,1,EG,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Prior,Stephen ,WF,,,09-01-26,12,6,05-16-25,3,LP,05-30-25,3,CL,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Prondzinski,Patrick ,WF,,,07-12-26,12,6,09-10-25,1,LP,11.08.25,1,WAH,12.14.25,1,sew,12.27.25,1,SEW,12-28-25,2,CRE,,,,,,,,,,,,,,,,,,,,,,
Rajjoub,Tammam ,CH,,,01-05-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Rametta,Amanda,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Reid,Thomas ,CH,,,11-14-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Reynolds,Drew,WF,,,01-19-27,12,11,02-10-26,1,EJ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Reynolds,David,WF,,,09-15-26,12,10,09-27-25,2,RB,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Rice,Lauren ,CH,,,12-09-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Richard,Regina,CH,,,05-08-26,12,11,09-23-25,1,ME,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Riddle,Ross ,CH,,,10-07-26,12,6,01-10-26,2,CRE,01-24-26,2,CRE,01-31-26,2,CRE,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Rinksalis,Domas ,CH,,,03-06-26,12,5,03-05-25,1,ME,03-31-25,1,VJW,04-14-25,1,VJW,12-08-25,3,lp,02-13-26,1,,,,,,,,,,,,,,,,,,,,,,,
Roberts,Trevlyn,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Rodabaugh,Kyle ,WF,,,02-16-26,12,8,02-26-25,1,MC,05-23-25,1,?,05-30-25,1,CL,06-13-25,1,EB,,,,,,,,,,,,,,,,,,,,,,,,,
Rodriguez,Fernando,CH,,Marcela,01-12-27,12,10,1.22.26,2,VJW,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Ross,Sandy,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Rupert,Diane ,WF,,,01-01-27,12,9,02.06.26,3,WAH,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Russell,Rita ,WF,,,10-01-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Rutherford,Nakki ,WF,,,12-01-26,12,6,12-18-25,3,JS,12-24-25,2,WH,01-09-26,3,MM,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Safdar,Komal ,CH,,,02-05-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Safdar,Mehvish,CH,College Platinum,,02-12-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Said,Sammy,CH,,,01-18-27,12,11,01-29-26,1,SEW,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Salatino,Kerry ,CH,,,07-22-26,12,4,08-17-25,1,CRE,11-28-25,1,CRE,12-30-25,1,CRE,01-11-26,1,CRE,1.24.26,1,SEW,1-29=26,2,?,02-11-26,1,ME,,,,,,,,,,,,,,,,
Santhosh Nair,Saurav ,Gr,,,01-08-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Schoolar,Marika ,CH,,Jonathan,02-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Sevilla,Milton,WF,,,12-08-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Simpson,Sheila,CH,,,12-17-26,12,11,01-12-26,1,LP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Singh,Komaljit,CH,Medical Suspension,,04-01-25,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Sinsangkeo,Joe ,CH,,Janice Ramsay,01-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Slagill,Connor ,CH,,,07-11-26,12,9,07-20-25,1,MP,08-31-25,1,CRE,1.22.26,1,SEW,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Smail,Emily,,Holiday Classic Winner,,12-07-25,1,0,12-10-25,1,MM,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Smith,Sally ,CH,,,01-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Smith,Teri ,CH,,,04-09-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Snyder,Randall ,CH,,,11-02-26,12,11,2.15.26,1,SEW,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Soll,Jack ,CH,Medical Suspension,Renuka Soll,03-02-25,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Spitzer,Jeffrey,Gr,,,01-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Sowell,Keith,,Holiday Classic Winner,,12-07-25,1,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Stacey-Bothwell,Kirsten,CH,,,04-08-26,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Stamatti,Ricardo,WF,,Alessia,10-20-26,12,6,10-23-25,1,SF,11-09-25,4,MJS,11-11-25,1,EJ,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Stangland,Karin,WF,,Jim Stangland,10-01-26,12,8,11-26-25,1,mm,11-26-25,1,LP,12-29-25,1,mm,02-07-26,1,LP,,,,,,,,,,,,,,,,,,,,,,,,,
Starkweather,Maria,Gr,,,10-16-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Statkevicus,Kimberly ,CH,,,01-01-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Stewart,Chris,CH,,,01-10-27,12,11,1.18.26,1,SEW,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
,,,,,01-01-25,12,2,09.02.25,1,WAH,10.09.25,1,WAH,10.20.25,1,WAH,10.27.25,1,WAH,11-19-25,1,MM,12-01-25,1,JS,12-04-25,2,LP,12-17-25,2,LP,12.29.25,1,WAH,,,,,,,,,,
Stine,Rachel ,CH,,,06-22-26,12,0,07-02-25,1,WH,07-09-25,2,WH,07-25-25,4,CRE,11.29.25,1,SEW,12-26-25,3,LP,02-07-26,1,WH,,,,,,,,,,,,,,,,,,,
,,,,,12-29-24,12,9,03-17-25,1,ME,04-03-25,1,MP,06-09-25,1,ME,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Storm,Tina ,CH,,,01-15-27,12,12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
Strawbridge,Anna ,CH,,,09-01-26,12,11,11-18-25,1,VJW,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,`;

  const lines = rawCSV.split('\n');
  let addedMembers = 0;
  let addedUsages = 0;
  let lastMemberId = null;

  for (let i = 1; i < lines.length; i++) {
    const line = lines[i].trim();
    if (!line) continue;

    // Split by commas
    const cols = line.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
    
    const lastName = cols[0]?.replace(/"/g, '').trim();
    const firstName = cols[1]?.replace(/"/g, '').trim();
    
    let targetMemberId = null;

    // Is this a completely new user?
    if (lastName) {
      const member = await prisma.member.create({
        data: {
          lastName: lastName,
          firstName: firstName || '',
          location: cols[2]?.trim() || '',
          notes: cols[3]?.replace(/"/g, '').trim() || '',
          family: cols[4]?.replace(/"/g, '').trim() || '',
          renewalDate: cols[5]?.trim() || '',
          totalPasses: parseInt(cols[6]) || 12
        }
      });
      addedMembers++;
      targetMemberId = member.id;
      lastMemberId = member.id; // Remember this person just in case the next row is an overflow row!
    } 
    // Is this a blank "Overflow" row that belongs to the person directly above it?
    else if (lastMemberId) {
      targetMemberId = lastMemberId;
    } 
    // If it's blank and we don't know who it belongs to, skip it
    else {
      continue;
    }

    // Now loop through their usages! (They start at column index 8)
    for (let j = 8; j < cols.length - 2; j += 3) {
      const uDate = cols[j]?.trim();
      const uAmtRaw = cols[j+1]?.trim();
      const uInit = cols[j+2]?.trim();

      // If the date and amount aren't completely blank...
      if (uDate && uAmtRaw) {
        const uAmt = parseInt(uAmtRaw);
        
        // ONLY save it to the database if it is actually a real, valid number!
        if (!isNaN(uAmt)) { 
          await prisma.passUsage.create({
            data: {
              memberId: targetMemberId,
              dateUsed: uDate,
              amount: uAmt,
              initials: uInit || ''
            }
          });
          addedUsages++;
        }
      }
    }
  }

  return NextResponse.json({ message: "Import success!", members: addedMembers, usages: addedUsages });
}